```bash

1. Open the lab
2. Select a blog  --  View post
3. Open View Page Source
4. Look for this interesting JS file
    <script src='/resources/js/domPurify-2.0.15.js'></script>
    <script src='/resources/js/loadCommentsWithDomClobbering.js'></script>

5. Analyse this JS file  /resources/js/loadCommentsWithDomClobbering.js

   let defaultAvatar = window.defaultAvatar || {avatar: '/resources/images/avatarDefault.svg'}
   let avatarImgHTML = '<img class="avatar" src="' + (comment.avatar ? escapeHTML(comment.avatar) : defaultAvatar.avatar) + '">';


EXPLAINATION

* `window.defaultAvatar || { avatar: '/resources/images/avatarDefault.svg' }`
  * Checks if `window.defaultAvatar` exists
  * If it exists → use it
  * If not → use the fallback object with a default avatar image

* `let defaultAvatar = ...`
  * Stores the result (existing or fallback avatar) in `defaultAvatar`

* `(comment.avatar ? escapeHTML(comment.avatar) : defaultAvatar.avatar)`
  * Checks if `comment.avatar` exist
  * If yes → use the escaped `comment.avatar` value
  * If no → use `defaultAvatar.avatar`

* `escapeHTML(comment.avatar)`
  * Sanitizes the avatar URL to prevent HTML/script injection

* `avatarImgHTML = '<img class="avatar" src="...">'`
  * Creates an HTML `<img>` tag string
  * Sets the image source (`src`) to either the user’s avatar or the default image

PAYLOAD

<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert();//">

6. Open a blog and upload it twice. After uploading it twice, the payload will execute and done

```
